{% extends "base.html" %} {% block title %}Cart — Revontulet Flamehouse{% endblock %} {% block content %}
<section class="cart-section">
  <div class="cart-header">
    <h2>Your Cart</h2>
  </div>
  
  <div id="cart-items" class="cart-items-container">
    <!-- Cart items will be dynamically inserted here -->
  </div>
  
  <div id="cart-empty" class="cart-empty" style="display: none; text-align: center; padding: 3rem;">
    <p style="color: #a8d8ff; font-size: 1.2rem;">Your cart is empty</p>
    <a href="{{ url_for('menu') }}" style="color: #00ff88; text-decoration: none; margin-top: 1rem; display: inline-block;">← Back to Menu</a>
  </div>
  
  <div id="cart-summary" class="cart-summary" style="display: none;">
    <div style="text-align: right; padding: 2rem; border-top: 1px solid rgba(0, 255, 136, 0.3);">
      <p style="font-size: 1.2rem; color: #a8d8ff; margin-bottom: 1rem;">
        Total: <span id="total-price" style="color: #00ff88; font-weight: bold;">€0.00</span>
      </p>
      <button class="btn-checkout" style="background: #00ff88; color: #0b0b0b; padding: 0.75rem 2rem; border: none; border-radius: 0.5rem; font-weight: bold; cursor: pointer; font-size: 1rem; margin-right: 1rem;">
        Proceed to Checkout
      </button>
      <a href="{{ url_for('menu') }}" style="color: #00ff88; text-decoration: none; padding: 0.75rem 2rem; border: 1px solid #00ff88; border-radius: 0.5rem; display: inline-block; font-weight: bold;">Continue Shopping</a>
    </div>
  </div>
</section>
{% endblock %} {% block scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartItemsDiv = document.getElementById('cart-items');
    const cartEmptyDiv = document.getElementById('cart-empty');
    const cartSummaryDiv = document.getElementById('cart-summary');
    const totalPriceSpan = document.getElementById('total-price');
    
    if (cart.length === 0) {
      cartItemsDiv.style.display = 'none';
      cartEmptyDiv.style.display = 'block';
      cartSummaryDiv.style.display = 'none';
    } else {
      let totalPrice = 0;
      let cartHTML = '';
      
      cart.forEach((item, index) => {
        const itemTotal = item.price * (item.quantity || 1);
        totalPrice += itemTotal;
        
        cartHTML += `
          <div style="background: rgba(20, 20, 35, 0.8); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; display: flex; gap: 1.5rem;">
            <img src="${item.image_url}" alt="${item.name}" style="width: 120px; height: 120px; object-fit: cover; border-radius: 8px;">
            <div style="flex: 1;">
              <h3 style="color: #00ff88; margin-bottom: 0.5rem;">${item.name}</h3>
              <p style="color: #a8d8ff; margin-bottom: 0.5rem;">${item.description}</p>
              <p style="color: #b8eaff; margin-bottom: 1rem;">Price: <span style="color: #00ff88; font-weight: bold;">€${item.price.toFixed(2)}</span></p>
              <div style="display: flex; gap: 1rem; align-items: center;">
                <label style="color: #a8d8ff;">Qty: 
                  <input type="number" value="${item.quantity || 1}" min="1" style="width: 50px; padding: 0.25rem; border-radius: 4px; border: 1px solid #00ff88; background: #0b0b0b; color: #00ff88;" onchange="updateQuantity(${index}, this.value)">
                </label>
                <span style="color: #00ff88; font-weight: bold; margin-left: auto;">Subtotal: €${itemTotal.toFixed(2)}</span>
                <button onclick="removeFromCart(${index})" style="background: #ff6b6b; color: #fff; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; font-weight: bold;">Remove</button>
              </div>
            </div>
          </div>
        `;
      });
      
      cartItemsDiv.innerHTML = cartHTML;
      totalPriceSpan.textContent = '€' + totalPrice.toFixed(2);
      
      cartItemsDiv.style.display = 'block';
      cartEmptyDiv.style.display = 'none';
      cartSummaryDiv.style.display = 'block';
    }
  });
  
  function updateQuantity(index, newQuantity) {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    if (newQuantity > 0) {
      cart[index].quantity = parseInt(newQuantity);
      localStorage.setItem('cart', JSON.stringify(cart));
      location.reload();
    }
  }
  
  function removeFromCart(index) {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart.splice(index, 1);
    localStorage.setItem('cart', JSON.stringify(cart));
    location.reload();
  }
</script>
{% endblock %}
